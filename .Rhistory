cluster = c(3, 3, "Z"))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(3, 3, "Z"))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(3, 3, "Z"))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(3, 3, "Z"))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(3, 3, "Z"))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(3, 3, "Z"))
devtools::load_all(".")
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(3, "Y", "Z"))
devtools::load_all(".")
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(3, "Y", "Z"))
devtools::load_all(".")
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(3, "Y", "Z"))
matrix(30 * 5, 30, 5)
matrix(rnorm(30 * 5), 30, 5))
matrix(rnorm(30 * 5), 30, 5)
rpois(30 * 5)
rpois(30 * 5, 1)
rpois(30 * 5, 30)
rpois(30 * 5, 10)
matrix(rpois(30 * 5, 10), 30, 5)
matrix(rpois(30 * 5, 5), 30, 5)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaeu.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaeu.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
devtools::load_all(".")
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaeu.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaeu.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c("X", "Y", "Z"))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = 23)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = 23)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = 23)
datasaem.ns
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(23, 23, 23))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(23, 23, 23))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(23, 23, 23))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(23, 23, 23))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(23, 23, 23))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(23, 23, 23))
covr::report()
devtools::load_all(".")
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem)
covr::report()
covr::report()
devtools::load_all(".")
saeFH.mprop(formula = list(datasaem.ns$Y1 ~ datasaem.ns$X1,
datasaem.ns$Y2 ~ datasaem.ns$X2,
datasaem.ns$Y3 ~ datasaem.ns$X3),
vardir = datasaem.ns[, c("v1", "v2", "v3", "v12", "v13", "v23")])
saeFH.ns.mprop(formula = list(datasaem.ns$Y1 ~ datasaem.ns$X1,
datasaem.ns$Y2 ~ datasaem.ns$X2,
datasaem.ns$Y3 ~ datasaem.ns$X3),
vardir = datasaem.ns[, c("v1", "v2", "v3", "v12", "v13", "v23")])
saeFH.ns.mprop(formula = list(datasaem.ns$Y1 ~ datasaem.ns$X1,
datasaem.ns$Y2 ~ datasaem.ns$X2,
datasaem.ns$Y3 ~ datasaem.ns$X3),
vardir = datasaem.ns[, c("v1", "v2", "v3", "v12", "v13", "v23")])
covr::report()
covr::report()
devtools::load_all(".")
## Vardir may not contains NA values (vector of names)
data = datasaem.ns
data[1, "v1"] = NA
data
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
## Vardir may not contains NA values (vector of names)
data = datasaem
data[1, "v1"] = NA
saeFH.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
saeFH.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
## Vardir may not contains NA values (vector of names)
data = datasaem.ns
data[1, "v1"] = NA
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = data[, c("v1", "v2", "v3", "v12", "v13", "v23")],
data = data)
devtools::load_all(".")
saeFH.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
## Vardir may not contains NA values (vector of names)
data = datasaem
data[1, "v1"] = NA
saeFH.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
saeFH.mprop(formula = list(data$Y1 ~ data$X1,
data$Y2 ~ data$X2,
data$Y3 ~ data$X3),
vardir = data[, c("v1", "v2", "v3", "v12", "v13", "v23")])
devtools::load_all(".")
## Vardir may not contains NA values (vector of names)
data = datasaem.ns
data[1, "v1"] = NA
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem)
devtools::load_all(".")
saeFH.ns.mprop(formula = y ~ x1 + x2,
vardir = "vardir",
data = datasaeu.ns)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = "auto")
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(3, 3, 3))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = datasaem.ns[, c("c1", "c2", "c3")])
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c("X", "Y", "Z"))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = matrix(rpois(30 * 5, 5), 30, 5))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(23, 23, 23))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem)
saeFH.ns.mprop(formula = list(datasaem.ns$Y1 ~ datasaem.ns$X1,
datasaem.ns$Y2 ~ datasaem.ns$X2,
datasaem.ns$Y3 ~ datasaem.ns$X3),
vardir = datasaem.ns[, c("v1", "v2", "v3", "v12", "v13", "v23")])
# Case of response variable is not a proportion
data = datasaem.ns
data[1,"Y1"] = 1.5
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
expect_error(
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
saeFH.ns.mprop(formula = list(datasaem.ns$Y1 ~ datasaem.ns$X1,
datasaem.ns$Y2 ~ datasaem.ns$X2,
datasaem.ns$Y3 ~ datasaem.ns$X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"))
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v2e"),
data = datasaem.ns)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13"),
data = datasaem.ns)
## Vardir may not contains NA values (vector of names)
data = datasaem.ns
data[1, "v1"] = NA
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
covr::report()
covr::report()
devtools::load_all(".")
## Vardir may not contains NA values (vector of names)
data = datasaem
data[1, "v1"] = NA
saeFH.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
devtools::load_all(".")
covr::report()
devtools::load_all(".")
saeFH.ns.mprop(formula = list(datasaem.ns$Y1 ~ datasaem.ns$X1,
datasaem.ns$Y2 ~ datasaem.ns$X2,
datasaem.ns$Y3 ~ datasaem.ns$X3),
vardir = datasaem.ns[, c("v1", "v2", "v3", "v12", "v13")])
# Case of Fisher information formed in REML is singular
data = read.csv("data/multi-REMLfail.csv")
data = read.csv("tests/testthat/data/multi-REMLfail.csv")
data
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
devtools::load_all(".")
data
saeFH.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data)
saeFH.ns.uprop(formula = y ~ x1 + x2,
vardir = "vardir",
data = datasaeu.ns,
cluster = 23)
saeFH.ns.uprop(formula = y ~ x1 + x2,
vardir = "vardir",
data = datasaeu.ns,
cluster = 23)
saeFH.ns.uprop(formula = y ~ x1 + x2,
vardir = "vardir",
data = datasaeu.ns,
cluster = 23)
saeFH.ns.uprop(formula = y ~ x1 + x2,
vardir = "vardir",
data = datasaeu.ns,
cluster = 23)
saeFH.ns.uprop(formula = y ~ x1 + x2,
vardir = "vardir",
data = datasaeu.ns,
cluster = 23)
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(23, 23, 23))
devtools::load_all(".")
saeFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = datasaem.ns,
cluster = c(23, 23, 23))
covr::report()
covr::report()
usethis::use_test("mseFH-ns-mprop")
covr::report()
devtools::load_all(".")
mseFH.ns.mprop(formula = y ~ x1 + x2,
vardir = "vardir",
data = datasaeu.ns,
B = 3)
devtools::load_all(".")
mseFH.ns.mprop(formula = y ~ x1 + x2,
vardir = "vardir",
data = datasaeu.ns,
B = 3)
devtools::load_all(".")
mseFH.ns.mprop(formula = y ~ x1 + x2,
vardir = "vardir",
data = datasaeu.ns,
B = 3)
covr::report()
covr::report()
covr::report()
covr::report()
devtools::load_all(".")
# Case of response variable is not a proportion
data = datasaem.ns
data[1,"Y1"] = 1.5
mseFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data,
B = 3)
devtools::load_all(".")
# Case of response variable is not a proportion
data = datasaem.ns
data[1,"Y1"] = 1.5
mseFH.ns.mprop(formula = list(Y1 ~ X1,
Y2 ~ X2,
Y3 ~ X3),
vardir = c("v1", "v2", "v3", "v12", "v13", "v23"),
data = data,
B = 3)
covr::report()
covr::report()
covr::report()
